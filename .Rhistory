library(readr)
return_data <- read_delim("Prowess Data/76729_1_120_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(co_stkdate = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
top_shareholders <- read_delim("Prowess Data/76729_1_20_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(hpc_date = col_date(format = "%d-%m-%Y")), trim_ws = TRUE)
ownrship_data <- read_delim("Prowess Data/76729_1_7_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(coprd_date = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
fin_data_ann_igaap <- read_delim("Prowess Data/76729_1_75_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ca_finance1_year = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
dividend_data <- read_delim("Prowess Data/76729_1_125_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(div_announcement_date = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
# beta <- read_delim("Prowess Data/76729_1_150_20221212_125039_dat.txt",
# delim = "|", escape_double = FALSE, col_types = cols(cobeta_from_date = col_date(format = "%d-%m-%Y"),
# cobeta_to_date = col_date(format = "%d-%m-%Y")),
# trim_ws = TRUE)
employee_count <- read_delim("Prowess Data/76729_1_275_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(indasca_finance1_year = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
industry_data <- read_delim("Prowess Data/76729_1_5_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, trim_ws = TRUE)
ls()
rm(ls())
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
View(fin_data_qtrly)
colnames(fin_data_qtrly)
library(data.)
library(data.table)
library(data.table)
fin_data_qtrly_dt= data.table::data.table(fin_data_qtrly)
rm(fin_data_qtrly)
fin_data_qtrly_dt[,total_assets:= ciq_ntrm_net_fixed_assets + ciq_ntrm_cap_work_in_progress + ciq_ntrm_investments + ciq_ntrm_other_non_current_assets + ciq_ntrm_curr_assets_loans_n_advns + ciq_ntrm_other_assets + ciq_ntrm_deferred_tax_asst + ciq_ntrm_misc_exp_not_written_off]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[,total_assets:= ciq_ntrm_net_fixed_assets + ciq_ntrm_cap_work_in_progress + ciq_ntrm_investments + ciq_ntrm_other_non_current_assets + ciq_ntrm_curr_assets_loans_n_advns + ciq_ntrm_other_assets + ciq_ntrm_deferred_tax_asst + ciq_ntrm_misc_exp_not_written_off, na.rm=TRUE]
fin_data_qtrly_dt[,total_assets:= sum(ciq_ntrm_net_fixed_assets , ciq_ntrm_cap_work_in_progress , ciq_ntrm_investments , ciq_ntrm_other_non_current_assets , ciq_ntrm_curr_assets_loans_n_advns , ciq_ntrm_other_assets , ciq_ntrm_deferred_tax_asst , ciq_ntrm_misc_exp_not_written_off, na.rm=TRUE)]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[, cash_holding := ciq_ntrm_cash_and_bank_balances/total_assets]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[, cash_holding := round(ciq_ntrm_cash_and_bank_balances/total_assets,4)]
fin_data_qtrly_dt[, cash_holding := round(ciq_ntrm_cash_and_bank_balances/total_assets,4)]
View(fin_data_qtrly_dt)
return_data <- read_delim("Prowess Data/76729_1_120_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(co_stkdate = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
View(return_data)
library(readr)
library(data.table)
return_data_dt = data.table::data.table(return_data)
rm(return_data)
View(return_data_dt)
View(fin_data_qtrly_dt)
View(return_data_dt)
head(return_data_dt[,c(1,3,6)])
head(return_data_dt[,c(1,3,7)])
View(fin_data_qtrly_dt)
colnames(fin_data_qtrly_dt[,c(1,3)])
colnames(return_data_dt[,c(1,3,7)])
## Adding market cap data
fin_data_qtrly_dt <- merge(fin_data_qtrly_dt, return_data_dt[,c(1,3,7)], by.x = c("ciq_interim_cocode","ciq_ntrm_date"), by.y = c("co_code","co_stkdate"))
View(fin_data_qtrly_dt)
library(readr)
library(data.table)
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
fin_data_qtrly_dt= data.table::data.table(fin_data_qtrly)
rm(fin_data_qtrly)
fin_data_qtrly_dt[,total_assets:= sum(ciq_ntrm_net_fixed_assets , ciq_ntrm_cap_work_in_progress , ciq_ntrm_investments , ciq_ntrm_other_non_current_assets , ciq_ntrm_curr_assets_loans_n_advns , ciq_ntrm_other_assets , ciq_ntrm_deferred_tax_asst , ciq_ntrm_misc_exp_not_written_off, na.rm=TRUE)]
fin_data_qtrly_dt[, cash_holding := ciq_ntrm_cash_and_bank_balances/total_assets]
## Return Data ####
return_data <- read_delim("Prowess Data/76729_1_120_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(co_stkdate = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
return_data_dt = data.table::data.table(return_data)
rm(return_data)
## Adding market cap data
fin_data_qtrly_dt <- merge(fin_data_qtrly_dt, return_data_dt[,c(1,3,7,10)], by.x = c("ciq_interim_cocode","ciq_ntrm_date"), by.y = c("co_code","co_stkdate"))
View(fin_data_qtrly_dt)
colnames(fin_data_qtrly_dt[,c(47:48)])
fin_data_qtrly_dt[, book_market := equity_bv_on_stkdate/nse_market_cap]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[, cashflowtodebt := sum(nse_market_cap, ciq_ntrm_long_term_borrowings + total_assets*-1, na.rm=TRUE)/ciq_ntrm_cash_and_bank_balances]
fin_data_qtrly_dt[, cashproductvity := sum(nse_market_cap, ciq_ntrm_long_term_borrowings + total_assets*-1, na.rm=TRUE)/ciq_ntrm_cash_and_bank_balances]
fin_data_qtrly_dt$cashflowtodebt = NULL
View(fin_data_qtrly_dt)
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[, change_in_sales := ciq_ntrm_net_sales - lag(ciq_ntrm_net_sales,1), by= ciq_interim_cocode]
View(fin_data_qtrly_dt)
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[, sales_lag := lag(ciq_ntrm_net_sales,1), by= ciq_interim_cocode]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[, sales_lag := lag(ciq_ntrm_net_sales,n=1), by= ciq_interim_cocode]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[, sales_lag := lag(fin_data_qtrly_dt$ciq_ntrm_net_sales,n=1), by= fin_data_qtrly_dt$ciq_interim_cocode]
fin_data_qtrly_dt$
View(fin_data_qtrly_dt)
View(fin_data_qtrly_dt)
## Return Data ####
return_data <- read_delim("Prowess Data/76729_1_120_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(co_stkdate = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
library(readr)
library(data.table)
return_data <- read_delim("Prowess Data/76729_1_120_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(co_stkdate = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
top_shareholders <- read_delim("Prowess Data/76729_1_20_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(hpc_date = col_date(format = "%d-%m-%Y")), trim_ws = TRUE)
ownrship_data <- read_delim("Prowess Data/76729_1_7_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(coprd_date = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
fin_data_ann_igaap <- read_delim("Prowess Data/76729_1_75_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ca_finance1_year = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
dividend_data <- read_delim("Prowess Data/76729_1_125_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(div_announcement_date = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
# beta <- read_delim("Prowess Data/76729_1_150_20221212_125039_dat.txt",
# delim = "|", escape_double = FALSE, col_types = cols(cobeta_from_date = col_date(format = "%d-%m-%Y"),
# cobeta_to_date = col_date(format = "%d-%m-%Y")),
# trim_ws = TRUE)
employee_count <- read_delim("Prowess Data/76729_1_275_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(indasca_finance1_year = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
industry_data <- read_delim("Prowess Data/76729_1_5_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, trim_ws = TRUE)
############## Variable IDs ############
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
fin_data_qtrly_dt= data.table::data.table(fin_data_qtrly)
rm(fin_data_qtrly)
fin_data_qtrly_dt[,total_assets:= sum(ciq_ntrm_net_fixed_assets , ciq_ntrm_cap_work_in_progress , ciq_ntrm_investments , ciq_ntrm_other_non_current_assets , ciq_ntrm_curr_assets_loans_n_advns , ciq_ntrm_other_assets , ciq_ntrm_deferred_tax_asst , ciq_ntrm_misc_exp_not_written_off, na.rm=TRUE)]
fin_data_qtrly_dt[, cash_holding := ciq_ntrm_cash_and_bank_balances/total_assets]
## Return Data ####
return_data <- read_delim("Prowess Data/76729_1_120_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(co_stkdate = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
return_data_dt = data.table::data.table(return_data)
rm(return_data)
## Adding market cap data
fin_data_qtrly_dt <- merge(fin_data_qtrly_dt, return_data_dt[,c(1,3,7,10)], by.x = c("ciq_interim_cocode","ciq_ntrm_date"), by.y = c("co_code","co_stkdate"))
fin_data_qtrly_dt[, book_market := equity_bv_on_stkdate/nse_market_cap]
fin_data_qtrly_dt[, cashproductvity := sum(nse_market_cap, ciq_ntrm_long_term_borrowings + total_assets*-1, na.rm=TRUE)/ciq_ntrm_cash_and_bank_balances]
# fin_data_qtrly_dt[, change_in_sales := ciq_ntrm_net_sales - lag(ciq_ntrm_net_sales,1), by= ciq_interim_cocode]
fin_data_qtrly_dt[, change_in_sales := ciq_ntrm_net_sales - lag(ciq_ntrm_net_sales,1), by= ciq_interim_cocode]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[, change_in_sales := ciq_ntrm_net_sales - shift(ciq_ntrm_net_sales,1), by= ciq_interim_cocode]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[!is.na(ciq_ntrm_net_sales) & !is.na(shift(ciq_ntrm_net_sales)), change_in_sales := ciq_ntrm_net_sales - shift(ciq_ntrm_net_sales,1), by= ciq_interim_cocode]
View(fin_data_qtrly_dt)
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
############## Variable IDs ############
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
fin_data_qtrly_dt= data.table::data.table(fin_data_qtrly)
rm(fin_data_qtrly)
View(fin_data_qtrly_dt)
is.na(fin_data_qtrly) <- 0
is.na(fin_data_qtrly_dt) <- 0
fin_data_qtrly_dt[is.na(fin_data_qtrly_dt)] <- 0
fin_data_qtrly_dt[ ,total_assets:= ciq_ntrm_net_fixed_assets + ciq_ntrm_cap_work_in_progress + ciq_ntrm_investments + ciq_ntrm_other_non_current_assets + ciq_ntrm_curr_assets_loans_n_advns + ciq_ntrm_other_assets + ciq_ntrm_deferred_tax_asst + ciq_ntrm_misc_exp_not_written_off]
View(fin_data_qtrly_dt)
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
fin_data_qtrly_dt= data.table::data.table(fin_data_qtrly)
rm(fin_data_qtrly)
View(fin_data_qtrly_dt)
## Return Data ####
return_data <- read_delim("Prowess Data/76729_1_120_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(co_stkdate = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
return_data_dt = data.table::data.table(return_data)
rm(return_data)
## Adding market cap data
fin_data_qtrly_dt <- merge(fin_data_qtrly_dt, return_data_dt[,c(1,3,7,10)], by.x = c("ciq_interim_cocode","ciq_ntrm_date"), by.y = c("co_code","co_stkdate"))
View(fin_data_qtrly_dt)
#### variables calculation
fin_data_qtrly_dt[, book_market := equity_bv_on_stkdate/nse_market_cap]
fin_data_qtrly_dt[, cashproductvity := sum(nse_market_cap, ciq_ntrm_long_term_borrowings + total_assets*-1, na.rm=TRUE)/ciq_ntrm_cash_and_bank_balances]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[!is.na(ciq_ntrm_net_sales) & !is.na(shift(ciq_ntrm_net_sales)), change_in_sales := ciq_ntrm_net_sales - shift(ciq_ntrm_net_sales,1), by= ciq_interim_cocode]
fin_data_qtrly_dt[!is.na(ciq_ntrm_net_sales) & !is.na(shift(ciq_ntrm_net_sales)), change_in_sales := ciq_ntrm_net_sales - shift(ciq_ntrm_net_sales), by= ciq_interim_cocode]
View(fin_data_qtrly_dt)
############## Variable IDs ############
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
fin_data_qtrly_dt= data.table::data.table(fin_data_qtrly)
rm(fin_data_qtrly)
## Return Data ####
return_data <- read_delim("Prowess Data/76729_1_120_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(co_stkdate = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
return_data_dt = data.table::data.table(return_data)
rm(return_data)
## Adding market cap and book value data
fin_data_qtrly_dt <- merge(fin_data_qtrly_dt, return_data_dt[,c(1,3,7,10)], by.x = c("ciq_interim_cocode","ciq_ntrm_date"), by.y = c("co_code","co_stkdate"))
fin_data_qtrly_dt[order(fin_data_qtrly_dt[,1],DT[,2])]
fin_data_qtrly_dt[, book_market := equity_bv_on_stkdate/nse_market_cap]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[date_diff := ciq_ntrm_date - shift(ciq_ntrm_date), by = ciq_interim_cocode]
fin_data_qtrly_dt[,date_diff := ciq_ntrm_date - shift(ciq_ntrm_date), by = ciq_interim_cocode]
View(fin_data_qtrly_dt)
table(fin_data_qtrly_dt$date_diff)
View(fin_data_qtrly_dt)
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[!is.na(ciq_ntrm_net_sales) & !is.na(shift(ciq_ntrm_net_sales) & date_diff < 95), change_in_sales := ciq_ntrm_net_sales - shift(ciq_ntrm_net_sales), by= ciq_interim_cocode]
View(fin_data_qtrly_dt)
##### Based on Total Assets ######
fin_data_qtrly_dt[ ,total_assets:= ciq_ntrm_net_fixed_assets + ciq_ntrm_cap_work_in_progress + ciq_ntrm_investments + ciq_ntrm_other_non_current_assets + ciq_ntrm_curr_assets_loans_n_advns + ciq_ntrm_other_assets + ciq_ntrm_deferred_tax_asst + ciq_ntrm_misc_exp_not_written_off]
View(fin_data_qtrly_dt)
##### Based on Total Assets ######
nrow(fin_data_qtrly_dt)
##### Based on Total Assets ######
for(1:nrow(fin_data_qtrly_dt))
##### Based on Total Assets ######
for (i in 1:nrow(fin_data_qtrly_dt)) {
print i
nrow(fin_data_qtrly_dt)
##### Based on Total Assets ######
for (i in 1:nrow(fin_data_qtrly_dt)) {
print (i)
}
##### Based on Total Assets ######
for (i in 1:nrow(fin_data_qtrly_dt)) {
print (i)
fin_data_qtrly_dt$total_assets[i] = sum(fin_data_qtrly_dt$ciq_ntrm_net_fixed_assets[i] + fin_data_qtrly_dt$ciq_ntrm_cap_work_in_progress[i] + fin_data_qtrly_dt$ciq_ntrm_investments[i] + fin_data_qtrly_dt$ciq_ntrm_other_non_current_assets[i] + fin_data_qtrly_dt$ciq_ntrm_curr_assets_loans_n_advns[i] + fin_data_qtrly_dt$ciq_ntrm_other_assets[i] + fin_data_qtrly_dt$ciq_ntrm_deferred_tax_asst[i] + fin_data_qtrly_dt$ciq_ntrm_misc_exp_not_written_off[i], na.rm = TRUE)
}
View(fin_data_qtrly_dt)
table(fin_data_qtrly_dt$total_assets)
##### Based on Total Assets ######
for (i in 1:nrow(fin_data_qtrly_dt)) {
print (i)
fin_data_qtrly_dt$total_assets[i] = sum(fin_data_qtrly_dt$ciq_ntrm_net_fixed_assets[i] , fin_data_qtrly_dt$ciq_ntrm_cap_work_in_progress[i] , fin_data_qtrly_dt$ciq_ntrm_investments[i] , fin_data_qtrly_dt$ciq_ntrm_other_non_current_assets[i] , fin_data_qtrly_dt$ciq_ntrm_curr_assets_loans_n_advns[i] , fin_data_qtrly_dt$ciq_ntrm_other_assets[i] , fin_data_qtrly_dt$ciq_ntrm_deferred_tax_asst[i] , fin_data_qtrly_dt$ciq_ntrm_misc_exp_not_written_off[i], na.rm = TRUE)
}
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[!is.na(total_assets), cash_holding := ciq_ntrm_cash_and_bank_balances/total_assets]
fin_data_qtrly_dt[!is.na(total_assets), cashproductvity := sum(nse_market_cap, ciq_ntrm_long_term_borrowings + total_assets*-1, na.rm=TRUE)/ciq_ntrm_cash_and_bank_balances]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[!is.na(total_assets), cashproductvity := (nse_market_cap + ciq_ntrm_long_term_borrowings - total_assets)/ciq_ntrm_cash_and_bank_balances]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[!is.na(total_assets), cash_holding := ciq_ntrm_cash_and_bank_balances/total_assets]
fin_data_qtrly_dt[total_assets > 0, cash_holding := ciq_ntrm_cash_and_bank_balances/total_assets]
View(fin_data_qtrly_dt)
fin_data_qtrly_dt$cashproductvity
View(fin_data_qtrly_dt)
fin_data_qtrly_dt[!is.na(ciq_ntrm_net_sales) & !is.na(shift(ciq_ntrm_net_sales) & date_diff < 95), change_in_sales := ciq_ntrm_net_sales - shift(ciq_ntrm_net_sales), by= ciq_interim_cocode]
View(fin_data_qtrly_dt)
library(readr)
library(data.table)
return_data <- read_delim("Prowess Data/76729_1_120_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(co_stkdate = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
top_shareholders <- read_delim("Prowess Data/76729_1_20_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(hpc_date = col_date(format = "%d-%m-%Y")), trim_ws = TRUE)
ownrship_data <- read_delim("Prowess Data/76729_1_7_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(coprd_date = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
dividend_data <- read_delim("Prowess Data/76729_1_125_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(div_announcement_date = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
employee_count <- read_delim("Prowess Data/76729_1_275_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(indasca_finance1_year = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
View(employee_count)
View(employee_count)
employee_count_dt = data.table::data.table(employee_count)
rm(employee_count_dt)
employee_count_dt = na.omit(employee_count_dt)
employee_count <- read_delim("Prowess Data/76729_1_275_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(indasca_finance1_year = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
employee_count_dt = data.table::data.table(employee_count)
rm(employee_count_dt)
employee_count_dt = na.omit(employee_count_dt)
employee_count <- read_delim("Prowess Data/76729_1_275_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(indasca_finance1_year = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
employee_count_dt = data.table::data.table(employee_count)
rm(employee_count)
employee_count_dt = na.omit(employee_count_dt)
industry_data_dt = data.table::data.table(industry_data)
rm(industry_data)
industry_data <- read_delim("Prowess Data/76729_1_5_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, trim_ws = TRUE)
industry_data_dt = data.table::data.table(industry_data)
rm(industry_data)
View(industry_data_dt)
top_shareholders <- read_delim("Prowess Data/76729_1_20_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(hpc_date = col_date(format = "%d-%m-%Y")), trim_ws = TRUE)
View(top_shareholders)
## Return Data ####
return_data <- read_delim("Prowess Data/76729_1_120_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(co_stkdate = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
return_data_dt = data.table::data.table(return_data)
rm(return_data)
View(industry_data_dt)
View(return_data_dt)
ownrship_data <- read_delim("Prowess Data/76729_1_7_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(coprd_date = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
View(ownrship_data)
ownrship_data_dt = data.table::data.table(ownrship_data)
rm(ownrship_data)
View(ownrship_data_dt)
colnames(ownrship_data_dt)
fin_data_qtrly_dt <- merge(fin_data_qtrly_dt, ownrship_data_dt, by.x = c("ciq_interim_cocode","ciq_ntrm_date"), by.y = c("coprd_company_code","coprd_date"))
############## Variable IDs ############
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
fin_data_qtrly_dt= data.table::data.table(fin_data_qtrly)
rm(fin_data_qtrly)
ownrship_data <- read_delim("Prowess Data/76729_1_7_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(coprd_date = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
ownrship_data_dt = data.table::data.table(ownrship_data)
rm(ownrship_data)
fin_data_qtrly_dt <- merge(fin_data_qtrly_dt, ownrship_data_dt, by.x = c("ciq_interim_cocode","ciq_ntrm_date"), by.y = c("coprd_company_code","coprd_date"))
View(fin_data_qtrly_dt)
View(fin_data_qtrly_dt)
rm(ownrship_data_dt)
employee_count <- read_delim("Prowess Data/76729_1_275_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(indasca_finance1_year = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
employee_count_dt = data.table::data.table(employee_count)
rm(employee_count)
employee_count_dt = na.omit(employee_count_dt)
View(employee_count_dt)
colnames(employee_count_dt)
fin_data_qtrly_dt <- merge(fin_data_qtrly_dt, employee_count_dt[,c(1,3,5)], by.x = c("ciq_interim_cocode","ciq_ntrm_date"), by.y = c("indasca_finance1_cocode","indasca_finance1_year"))
View(fin_data_qtrly_dt)
############## Variable IDs ############
fin_data_qtrly <- read_delim("Prowess Data/76729_1_100_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(ciq_ntrm_date = col_date(format = "%d-%m-%Y"),
ciq_ntrm_share_appln_suspense = col_double(),
ciq_ntrm_misc_exp_not_written_off = col_double()),
trim_ws = TRUE)
fin_data_qtrly_dt= data.table::data.table(fin_data_qtrly)
rm(fin_data_qtrly)
ownrship_data <- read_delim("Prowess Data/76729_1_7_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(coprd_date = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
ownrship_data_dt = data.table::data.table(ownrship_data)
rm(ownrship_data)
fin_data_qtrly_dt <- merge(fin_data_qtrly_dt, ownrship_data_dt, by.x = c("ciq_interim_cocode","ciq_ntrm_date"), by.y = c("coprd_company_code","coprd_date"), all.x = TRUE)
rm(ownrship_data_dt)
employee_count <- read_delim("Prowess Data/76729_1_275_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(indasca_finance1_year = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
employee_count_dt = data.table::data.table(employee_count)
rm(employee_count)
employee_count_dt = na.omit(employee_count_dt)
fin_data_qtrly_dt <- merge(fin_data_qtrly_dt, employee_count_dt[,c(1,3,5)], by.x = c("ciq_interim_cocode","ciq_ntrm_date"), by.y = c("indasca_finance1_cocode","indasca_finance1_year"), all.x = TRUE)
rm(employee_count_dt)
## Return Data ####
return_data <- read_delim("Prowess Data/76729_1_120_20221212_125039_dat.txt",
delim = "|", escape_double = FALSE, col_types = cols(co_stkdate = col_date(format = "%d-%m-%Y")),
trim_ws = TRUE)
return_data_dt = data.table::data.table(return_data)
rm(return_data)
## Adding market cap and book value data
fin_data_qtrly_dt <- merge(fin_data_qtrly_dt, return_data_dt[,c(1,3,7,10)], by.x = c("ciq_interim_cocode","ciq_ntrm_date"), by.y = c("co_code","co_stkdate"))
fin_data_qtrly_dt[order(fin_data_qtrly_dt[,1],DT[,2])]
fin_data_qtrly_dt[,date_diff := ciq_ntrm_date - shift(ciq_ntrm_date), by = ciq_interim_cocode] ## for compounding quarterly changes
fin_data_qtrly_dt[, book_market := equity_bv_on_stkdate/nse_market_cap]
for (i in 1:nrow(fin_data_qtrly_dt)) {
print (i)
fin_data_qtrly_dt$total_assets[i] = sum(fin_data_qtrly_dt$ciq_ntrm_net_fixed_assets[i] , fin_data_qtrly_dt$ciq_ntrm_cap_work_in_progress[i] , fin_data_qtrly_dt$ciq_ntrm_investments[i] , fin_data_qtrly_dt$ciq_ntrm_other_non_current_assets[i] , fin_data_qtrly_dt$ciq_ntrm_curr_assets_loans_n_advns[i] , fin_data_qtrly_dt$ciq_ntrm_other_assets[i] , fin_data_qtrly_dt$ciq_ntrm_deferred_tax_asst[i] , fin_data_qtrly_dt$ciq_ntrm_misc_exp_not_written_off[i], na.rm = TRUE)
}
fin_data_qtrly_dt[total_assets > 0, cash_holding := ciq_ntrm_cash_and_bank_balances/total_assets]
rm(i)
fin_data_qtrly_dt[total_assets > 0, cash_holding := ciq_ntrm_cash_and_bank_balances/total_assets]
fin_data_qtrly_dt[!is.na(total_assets), cashproductvity := (nse_market_cap + ciq_ntrm_long_term_borrowings - total_assets)/ciq_ntrm_cash_and_bank_balances]
fin_data_qtrly_dt[!is.na(ciq_ntrm_net_sales) & !is.na(shift(ciq_ntrm_net_sales) & date_diff < 95), change_in_sales := ciq_ntrm_net_sales - shift(ciq_ntrm_net_sales), by= ciq_interim_cocode]
View(fin_data_qtrly_dt)
saveRDS(fin_data_qtrly_dt)
saveRDS(fin_data_qtrly_dt, "fin_data_qtrly_dt.rds")
